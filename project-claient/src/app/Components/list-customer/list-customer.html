<div class="table-container" dir="rtl">
  @if (authSrv.isAdmin()) {
    <div class="header-section">
      <mat-icon class="header-icon">badge</mat-icon>
      <h2>ניהול משתתפי המכירה</h2>
      <p>רשימת לקוחות רשומים במערכת</p>
    </div>

    <table mat-table [dataSource]="arrModor" class="modern-table shadow-sm">

      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef> קוד רוכש </th>
        <td mat-cell *matCellDef="let g"> <span class="id-tag">{{ g.id }}</span> </td>
      </ng-container>

      <ng-container matColumnDef="fullName">
        <th mat-header-cell *matHeaderCellDef> לקוח </th>
        <td mat-cell *matCellDef="let g">
          <div class="customer-info">
            <div class="avatar">{{ g.firstName[0] }}{{ g.lastName[0] }}</div>
            <div class="name-box">
              <span class="full-name">{{ g.firstName }} {{ g.lastName }}</span>
              <span class="sub-text">{{ g.address }}</span>
            </div>
          </div>
        </td>
      </ng-container>

      <ng-container matColumnDef="contact">
        <th mat-header-cell *matHeaderCellDef> פרטי קשר </th>
        <td mat-cell *matCellDef="let g">
          <div class="contact-col">
            <span><mat-icon>phone</mat-icon> {{ g.phone }}</span>
            <span class="email-text"><mat-icon>mail</mat-icon> {{ g.email }}</span>
          </div>
        </td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef> פעולות </th>
        <td mat-cell *matCellDef="let g">
          <div class="action-buttons">
            <button mat-icon-button class="btn-edit" (click)="updateModor(g.id)" matTooltip="עריכה">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button class="btn-delete" (click)="removeCustomer(g.id)" matTooltip="מחיקה">
              <mat-icon>delete_outline</mat-icon>
            </button>
            
            @if(degel == g.id) {
              <button mat-button color="warn" class="btn-cancel" (click)="closeEdit(g.id)">
                ביטול
              </button>
            }
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['id', 'fullName', 'contact', 'actions']"></tr>
      <tr mat-row *matRowDef="let row; columns: ['id', 'fullName', 'contact', 'actions'];" class="modern-row"></tr>
    </table>
  } @else {
    <div class="access-denied-card">
      <mat-icon>lock</mat-icon>
      <h3>גישה מוגבלת</h3>
      <p>אין לך הרשאה לצפות ברשימת הלקוחות.</p>
    </div>
  }
</div>